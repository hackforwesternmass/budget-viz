(function(){(function(){var t,r,e,n,i,s,o,u,c,a,l,h,p=[].slice,d=[].indexOf||function(t){for(var r=0,e=this.length;e>r;r++)if(r in this&&this[r]===t)return r;return-1},f={}.hasOwnProperty,y=function(t,r){function e(){this.constructor=t}for(var n in r)f.call(r,n)&&(t[n]=r[n]);return e.prototype=r.prototype,t.prototype=new e,t.__super__=r.prototype,t},g=function(t,r){return function(){return t.apply(r,arguments)}};e={bind:function(t,r){var e,n,i,s,o;for(n=t.split(" "),e=this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),s=0,o=n.length;o>s;s++)i=n[s],e[i]||(e[i]=[]),e[i].push(r);return this},one:function(t,r){return this.bind(t,function(){return this.unbind(t,arguments.callee),r.apply(this,arguments)})},trigger:function(){var t,r,e,n,i,s,o;if(t=arguments.length>=1?p.call(arguments,0):[],e=t.shift(),n=this.hasOwnProperty("_callbacks")&&(null!=(o=this._callbacks)?o[e]:void 0)){for(i=0,s=n.length;s>i&&(r=n[i],r.apply(this,t)!==!1);i++);return!0}},unbind:function(t,r){var e,n,i,s,o,u,c,a,l,h;if(!t)return this._callbacks={},this;for(n=t.split(" "),u=0,a=n.length;a>u;u++)if(o=n[u],s=null!=(h=this._callbacks)?h[o]:void 0)if(r){for(i=c=0,l=s.length;l>c;i=++c)if(e=s[i],e===r){s=s.slice(),s.splice(i,1),this._callbacks[o]=s;break}}else delete this._callbacks[o];return this}},e.on=e.bind,e.off=e.unbind,n={trace:!0,logPrefix:"(App)",log:function(){var t;return t=arguments.length>=1?p.call(arguments,0):[],this.trace?(this.logPrefix&&t.unshift(this.logPrefix),"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,t),this):void 0}},h=["included","extended"],s=function(){function t(){"function"==typeof this.init&&this.init.apply(this,arguments)}return t.include=function(t){var r,e,n;if(!t)throw Error("include(obj) requires obj");for(r in t)e=t[r],0>d.call(h,r)&&(this.prototype[r]=e);return null!=(n=t.included)&&n.apply(this),this},t.extend=function(t){var r,e,n;if(!t)throw Error("extend(obj) requires obj");for(r in t)e=t[r],0>d.call(h,r)&&(this[r]=e);return null!=(n=t.extended)&&n.apply(this),this},t.proxy=function(t){var r=this;return function(){return t.apply(r,arguments)}},t.prototype.proxy=function(t){var r=this;return function(){return t.apply(r,arguments)}},t}(),i=function(r){function n(t){n.__super__.constructor.apply(this,arguments),t&&this.load(t),this.cid=this.constructor.uid("c-")}return y(n,r),n.extend(e),n.records={},n.crecords={},n.attributes=[],n.configure=function(){var t,r;return r=arguments[0],t=arguments.length>=2?p.call(arguments,1):[],this.className=r,this.records={},this.crecords={},t.length&&(this.attributes=t),this.attributes&&(this.attributes=l(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},n.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"},n.find=function(t){var r;if(r=this.records[t],!r&&(""+t).match(/c-\d+/))return this.findCID(t);if(!r)throw Error('"'+this.className+'" model could not find a record for the ID "'+t+'"');return r.clone()},n.findCID=function(t){var r;if(r=this.crecords[t],!r)throw Error('"'+this.className+'" model could not find a record for the ID "'+id+'"');return r.clone()},n.exists=function(t){try{return this.find(t)}catch(r){return!1}},n.refresh=function(t,r){var e,n,i,s;for(null==r&&(r={}),r.clear&&(this.records={},this.crecords={}),n=this.fromJSON(t),c(n)||(n=[n]),i=0,s=n.length;s>i;i++)e=n[i],e.id||(e.id=e.cid),this.records[e.id]=e,this.crecords[e.cid]=e;return this.trigger("refresh",this.cloneArray(n)),this},n.select=function(t){var r,e,n;return n=function(){var n,i;n=this.records,i=[];for(r in n)e=n[r],t(e)&&i.push(e);return i}.call(this),this.cloneArray(n)},n.findByAttribute=function(t,r){var e,n,i;i=this.records;for(e in i)if(n=i[e],n[t]===r)return n.clone();return null},n.findAllByAttribute=function(t,r){return this.select(function(e){return e[t]===r})},n.each=function(t){var r,e,n,i;n=this.records,i=[];for(r in n)e=n[r],i.push(t(e.clone()));return i},n.all=function(){return this.cloneArray(this.recordsValues())},n.first=function(){var t;return t=this.recordsValues()[0],null!=t?t.clone():void 0},n.last=function(){var t,r;return r=this.recordsValues(),t=r[r.length-1],null!=t?t.clone():void 0},n.count=function(){return this.recordsValues().length},n.deleteAll=function(){var t,r,e,n;e=this.records,n=[];for(t in e)r=e[t],n.push(delete this.records[t]);return n},n.destroyAll=function(t){var r,e,n,i;n=this.records,i=[];for(r in n)e=n[r],i.push(this.records[r].destroy(t));return i},n.update=function(t,r,e){return this.find(t).updateAttributes(r,e)},n.create=function(t,r){var e;return e=new this(t),e.save(r)},n.destroy=function(t,r){return this.find(t).destroy(r)},n.change=function(t){return"function"==typeof t?this.bind("change",t):this.trigger("change",t)},n.fetch=function(t){return"function"==typeof t?this.bind("fetch",t):this.trigger("fetch",t)},n.toJSON=function(){return this.recordsValues()},n.fromJSON=function(t){var r,e,n,i;if(t){if("string"==typeof t&&(t=JSON.parse(t)),c(t)){for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(new this(r));return i}return new this(t)}},n.fromForm=function(){var t;return(t=new this).fromForm.apply(t,arguments)},n.recordsValues=function(){var t,r,e,n;r=[],n=this.records;for(t in n)e=n[t],r.push(e);return r},n.cloneArray=function(t){var r,e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(r.clone());return i},n.idCounter=0,n.uid=function(t){var r;return null==t&&(t=""),r=t+this.idCounter++,this.exists(r)&&(r=this.uid(t)),r},n.prototype.isNew=function(){return!this.exists()},n.prototype.isValid=function(){return!this.validate()},n.prototype.validate=function(){},n.prototype.load=function(t){var r,e;for(r in t)e=t[r],"function"==typeof this[r]?this[r](e):this[r]=e;return this},n.prototype.attributes=function(){var t,r,e,n,i;for(r={},i=this.constructor.attributes,e=0,n=i.length;n>e;e++)t=i[e],t in this&&(r[t]="function"==typeof this[t]?this[t]():this[t]);return this.id&&(r.id=this.id),r},n.prototype.eql=function(t){return!!(t&&t.constructor===this.constructor&&t.cid===this.cid||t.id&&t.id===this.id)},n.prototype.save=function(t){var r,e;return null==t&&(t={}),t.validate!==!1&&(r=this.validate())?(this.trigger("error",r),!1):(this.trigger("beforeSave",t),e=this.isNew()?this.create(t):this.update(t),this.stripCloneAttrs(),this.trigger("save",t),e)},n.prototype.stripCloneAttrs=function(){var t,r;if(!this.hasOwnProperty("cid")){for(t in this)f.call(this,t)&&(r=this[t],this.constructor.attributes.indexOf(t)>-1&&delete this[t]);return this}},n.prototype.updateAttribute=function(t,r,e){var n;return n={},n[t]=r,this.updateAttributes(n,e)},n.prototype.updateAttributes=function(t,r){return this.load(t),this.save(r)},n.prototype.changeID=function(t){var r;return r=this.constructor.records,r[t]=r[this.id],delete r[this.id],this.id=t,this.save()},n.prototype.destroy=function(t){return null==t&&(t={}),this.trigger("beforeDestroy",t),delete this.constructor.records[this.id],delete this.constructor.crecords[this.cid],this.destroyed=!0,this.trigger("destroy",t),this.trigger("change","destroy",t),this.unbind(),this},n.prototype.dup=function(t){var r;return r=new this.constructor(this.attributes()),t===!1?r.cid=this.cid:delete r.id,r},n.prototype.clone=function(){return u(this)},n.prototype.reload=function(){var t;return this.isNew()?this:(t=this.constructor.find(this.id),this.load(t.attributes()),t)},n.prototype.toJSON=function(){return this.attributes()},n.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},n.prototype.fromForm=function(r){var e,n,i,s,o;for(n={},o=t(r).serializeArray(),i=0,s=o.length;s>i;i++)e=o[i],n[e.name]=e.value;return this.load(n)},n.prototype.exists=function(){return this.id&&this.id in this.constructor.records},n.prototype.update=function(t){var r,e;return this.trigger("beforeUpdate",t),e=this.constructor.records,e[this.id].load(this.attributes()),r=e[this.id].clone(),r.trigger("update",t),r.trigger("change","update",t),r},n.prototype.create=function(t){var r,e;return this.trigger("beforeCreate",t),this.id||(this.id=this.cid),e=this.dup(!1),this.constructor.records[this.id]=e,this.constructor.crecords[this.cid]=e,r=e.clone(),r.trigger("create",t),r.trigger("change","create",t),r},n.prototype.bind=function(t,r){var e,n,i=this;return this.constructor.bind(t,e=function(t){return t&&i.eql(t)?r.apply(i,arguments):void 0}),this.constructor.bind("unbind",n=function(r){return r&&i.eql(r)?(i.constructor.unbind(t,e),i.constructor.unbind("unbind",n)):void 0}),e},n.prototype.one=function(t,r){var e,n=this;return e=this.bind(t,function(){return n.constructor.unbind(t,e),r.apply(n,arguments)})},n.prototype.trigger=function(){var t,r;return t=arguments.length>=1?p.call(arguments,0):[],t.splice(1,0,this),(r=this.constructor).trigger.apply(r,t)},n.prototype.unbind=function(){return this.trigger("unbind")},n}(s),r=function(r){function i(r){this.release=g(this.release,this);var e,n,s;this.options=r,s=this.options;for(e in s)n=s[e],this[e]=n;this.el||(this.el=document.createElement(this.tag)),this.el=t(this.el),this.$el=this.el,this.className&&this.el.addClass(this.className),this.attributes&&this.el.attr(this.attributes),this.events||(this.events=this.constructor.events),this.elements||(this.elements=this.constructor.elements),this.events&&this.delegateEvents(this.events),this.elements&&this.refreshElements(),i.__super__.constructor.apply(this,arguments)}return y(i,r),i.include(e),i.include(n),i.prototype.eventSplitter=/^(\S+)\s*(.*)$/,i.prototype.tag="div",i.prototype.release=function(){return this.trigger("release"),this.el.remove(),this.unbind()},i.prototype.$=function(r){return t(r,this.el)},i.prototype.delegateEvents=function(t){var r,e,n,i,s,o,u=this;o=[];for(e in t){if(i=t[e],"function"==typeof i)i=function(t){return function(){return t.apply(u,arguments),!0}}(i);else{if(!this[i])throw Error(""+i+" doesn't exist");i=function(t){return function(){return u[t].apply(u,arguments),!0}}(i)}n=e.match(this.eventSplitter),r=n[1],s=n[2],""===s?o.push(this.el.bind(r,i)):o.push(this.el.delegate(s,r,i))}return o},i.prototype.refreshElements=function(){var t,r,e,n;e=this.elements,n=[];for(t in e)r=e[t],n.push(this[r]=this.$(t));return n},i.prototype.delay=function(t,r){return setTimeout(this.proxy(t),r||0)},i.prototype.html=function(t){return this.el.html(t.el||t),this.refreshElements(),this.el},i.prototype.append=function(){var t,r,e;return r=arguments.length>=1?p.call(arguments,0):[],r=function(){var e,n,i;for(i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.el||t);return i}(),(e=this.el).append.apply(e,r),this.refreshElements(),this.el},i.prototype.appendTo=function(t){return this.el.appendTo(t.el||t),this.refreshElements(),this.el},i.prototype.prepend=function(){var t,r,e;return r=arguments.length>=1?p.call(arguments,0):[],r=function(){var e,n,i;for(i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.el||t);return i}(),(e=this.el).prepend.apply(e,r),this.refreshElements(),this.el},i.prototype.replace=function(r){var e,n;return n=[this.el,t(r.el||r)],e=n[0],this.el=n[1],e.replaceWith(this.el),this.delegateEvents(this.events),this.refreshElements(),this.el},i}(s),t=("undefined"!=typeof window&&null!==window?window.jQuery:void 0)||("undefined"!=typeof window&&null!==window?window.Zepto:void 0)||function(t){return t},u=Object.create||function(t){var r;return r=function(){},r.prototype=t,new r},c=function(t){return"[object Array]"===Object.prototype.toString.call(t)},a=function(t){var r;if(!t)return!0;for(r in t)return!1;return!0},l=function(t){return Array.prototype.slice.call(t,0)},o=this.Spine={},"undefined"!=typeof module&&null!==module&&(console.log("module"),module.exports=o),o.version="1.0.9",o.isArray=c,o.isBlank=a,o.$=t,o.Events=e,o.Log=n,o.Module=s,o.Controller=r,o.Model=i,s.extend.call(o,e),s.create=s.sub=r.create=r.sub=i.sub=function(t,r){var e;return e=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return y(r,t),r}(this),t&&e.include(t),r&&e.extend(r),"function"==typeof e.unbind&&e.unbind(),e},i.setup=function(t,r){var e;return null==r&&(r=[]),e=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return y(r,t),r}(this),e.configure.apply(e,[t].concat(p.call(r))),e},o.Class=s}).call(this),define("spine",function(){}),function(){var t={}.hasOwnProperty,r=function(r,e){function n(){this.constructor=r}for(var i in e)t.call(e,i)&&(r[i]=e[i]);return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r},e=[].slice;define("data/models",["require","exports","module","spine"],function(t,n){var i,s,o,u;return o=window.Spine||t("spine"),i=o.$,s=function(t){function n(){return u=n.__super__.constructor.apply(this,arguments)}return r(n,t),n.configure.apply(n,["Base"].concat(e.call(n.attributes))),n.tryFind=function(t){var r;try{return this.find(t)}catch(e){return r=e,null}},n}(o.Model),n=null})}.call(this),function(){var t=function(t,r){return function(){return t.apply(r,arguments)}},r={}.hasOwnProperty,e=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};define("data/controllers",["require","exports","module","spine","data/models","d3"],function(r,n,i){var s,o,u,c,a;return c=window.Spine||r("spine"),s=c.$,u=r("data/models"),a=r("d3"),o=function(r){function n(){this.d3LoadCounties=t(this.d3LoadCounties,this),this.d3LoadStates=t(this.d3LoadStates,this),n.__super__.constructor.apply(this,arguments),this.d3LoadStates(),this.d3LoadCounties()}return e(n,r),n.prototype.map=null,n.prototype.d3LoadStates=function(){var t,r=this;return t=a.select("#"+this.el.attr("id")).append("svg"),this.states=t.append("g").attr("id","states"),this.states.attr("transform","scale(.75, .75)"),a.json("/static/data/geo/gz_2010_us_040_00_20m.json",function(t){return r.states.selectAll("path").data(t.features).enter().append("path").classed("state",!0).attr("d",a.geo.path().projection(a.geo.albersUsa())).attr("id",function(t){return t.properties.STATE}).style("fill-opacity",function(t){var r,e,n;return r=i.config().database_data,n=t.properties.STATE,e=r[0][n],.01*e.alpha}).on("mouseover",function(){return a.select(this).classed("hover",!0)}).on("mouseout",function(){return a.select(this).classed("hover",!1)}).append("svg:title").text(function(t){return t.properties.NAME})})},n.prototype.d3LoadCounties=function(){var t,r=this;return t=a.select("#map2").append("svg"),this.counties=t.append("g").attr("id","counties"),this.counties.attr("transform","scale(.75, .75)"),a.json("/static/data/app/geo/gz_2010_us_050_00_20m.json",function(t){return r.counties.selectAll("path").data(t.features).enter().append("path").classed("state",!0).attr("d",a.geo.path().projection(a.geo.albersUsa())).attr("id",function(t){return""+t.properties.STATE+t.properties.COUNTY}).style("fill-opacity",function(t){var r,e;return r=parseInt(t.properties.COUNTY,10),e=parseInt(t.properties.STATE,10),r/=200,1>r?r:1}).on("mouseover",function(){return a.select(this).classed("hover",!0)}).on("mouseout",function(){return a.select(this).classed("hover",!1)})})},n}(c.Controller),n={MapController:o}})}.call(this),function(){var t={}.hasOwnProperty,r=function(r,e){function n(){this.constructor=r}for(var i in e)t.call(e,i)&&(r[i]=e[i]);return n.prototype=e.prototype,r.prototype=new n,r.__super__=e.prototype,r};define("data/app",["require","exports","module","spine","data/controllers","data/models"],function(t,e){var n,i,s,o,u;return u=window.Spine||t("spine"),n=u.$,i=t("data/controllers"),o=t("data/models"),s=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.mapController=new i.MapController({el:n("div[data-controller=map]",this.el)})}return r(e,t),e}(u.Controller),e={MapViewController:s}})}.call(this),function(){define("app/js/map",["jquery","d3","data/app"],function(t,r,e){return new e.MapViewController({el:t("#database-app")})})}.call(this),require(["app/js/map"])})();
//@ sourceMappingURL=map.js.map